# Use standard Python ARM64 image and install uv
FROM --platform=linux/arm64 python:3.11-slim

WORKDIR /app

# Install uv package manager
RUN pip install uv

# Copy uv files  
COPY src/docker/pyproject.toml src/docker/uv.lock ./

# Install dependencies using uv
RUN uv sync --frozen --no-cache

# Install additional dependencies for Gateway
RUN uv add httpx requests

# Copy agent file
COPY src/agents/investment_bot_gateway.py ./

# Expose port
EXPOSE 8080

# Run application
CMD ["uv", "run", "uvicorn", "investment_bot_gateway:app", "--host", "0.0.0.0", "--port", "8080"]
